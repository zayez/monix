# Hosts

As already mentioned, the host will be responsible for setting configurations such as: desktop environment, file systems, fonts, multiboot support, system packages as well as manage programs and services at _system_ level.

The idea of this project is about using one of the available hosts as a **blueprint** to derivate another host and use the blueprint as a starting point. So, you shouldn't use a _host_ directly. Instead, you should copy an available host and use as a base for your own host configuration.

The hosts here are only a reference, they are not meant to be used.

## Athens

**Athens** is considered the _default_ host of this project, its recommended to use it as the _blueprint_ for new hosts. The main module (_default.nix_ always) is located at the _hosts/athens_ directory and we're going to start there.

### Default module

The default module will be the core of the host configuration. At the top of the file you can edit some basic settings like: username, keyboard layout, hostname, timeZone and the flag to use OSProber (will see this later).

In the the default module you will be able to manage configuration to boot, virtualisation and location. This file should be lean.
At the beginning of the module you should notice an _imports_, this will allow us to _compose_ our modules in a nice way. First, we will look at _file-systems_.

### File systems

The _file systems_ module is straightforward: you set a file system, tell where to mount, what device (by UUID or label) and what file system is and that's it.

### Multiboot support

If you want to enable multiboot with other operating systems you can simply enable the _OSProber_ in the default module and the system will figure out what you have installed and it will generate a grub configuration automatically when you build the system.

However, the build command will take a long time and you probably don't want to waste time every time you build your system configuration. What you can do is only enable the OSProber the first time you build your configuration and then you can use the grub configuration generated by NixOS to get the menu entry for the others systems.

First, use the template available to generate a _multiboot_ file:

```bash
cd path/to/host/
cp multiboot-template.nix multiboot.nix
```

Open the file to get an idea of what kind of stuff you gonna need to paste here.

Now, grab the desired new entries in the grub configuration file. You can check the entries by running (with sudo):

```bash
cat /boot/grub/grub.cfg
```

Paste the entries into `multiboot.nix` file.

Be aware, you only want the menuentry for the others systems, you don't need the menu entries for NixOS or any other stuff in there. If you look into the default module you can check the attribute `boot.loader.grub.extraEntries` to understand what is doing: It simply adds entries to grub.

### Common

The most common configurations will be enabled in this module, sound, pulseaudio, network-manager, the default shell (_zsh_), setting up the user and it's home directory, the default locate and the system version are all done in the `common.nix` module.

### Shared

The shared module composes all of the default modules of the base system: desktop environment, base fonts, system packages, programs and services.

### Customizing your host

This chapter should've given you an idea of how you should compose your own host. For modules that can be re-used by multiple hosts, you can follow the pattern used in the _athens_ host and save the module in the system directory.
For modules that are less reusable, they can be saved in the hosts directory.
